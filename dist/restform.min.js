/**
 * jquery-restform - jQuery plugin for an interactive JSON REST API console
 * @version v1.5.3
 * @link https://github.com/ecomclub/restform#readme
 * @author E-Com Club
 * @license MIT
 */
!function(t){"use strict";var p={},h=function(t){var e=t.opt,s=e.host+Restform.parseEndpoint(e.endpoint,e.params);return t.url=s},v=function(t,e,s){p[t].opt.reqBody=e;var a=!!s;b(t,null,a,!a)},b=function(t,e,s,a){var n,o=p[t],r=o.opt;if(n=e?{res:e}:{req:r.reqBody,res:r.resBody},!s){var i=o.bodyEditor;for(var l in i){var c=i[l];if("function"==typeof c)if(n[l])try{c(JSON.stringify(n[l],null,r.indentationSpaces))}catch(t){console.error("Invalid request body",t)}else c("")}}a||"function"!=typeof o.bodyForm||o.bodyForm(n.req)};t.fn.restform=function(t){var e,s,a,i=this.data("restform");i||(a=Date.now(),p[a]={opt:{title:"API Console",host:"https://api.e-com.plus/v1",endpoint:"/products/{_id}.json",method:"GET",params:[{key:"_id",value:"123",description:"Resource ID",required:!0}],reqHeaders:{"Content-Type":"application/json"},schema:null,reqBody:null,statusCode:200,resHeaders:{"Content-Type":"application/json"},resBody:null,aceTheme:"",indentationSpaces:4,chageHeadersCallback:null},liveResponse:{},url:""},i=a,s=!0);var n,o,r,l,c=p[i],d=c.opt;if("object"==typeof t&&t&&Object.assign(d,t),s){var u=Restform.layout(i);c.Layout=u,setTimeout(function(){var t=function(t){v(i,t,!0)},e={req:u.$reqBody,res:u.$resBody};for(var s in c.bodyEditor={},e){var a,n=e[s];if(n)"res"===s&&(a=!0),c.bodyEditor[s]=Restform.setupAce(n,a,d.aceTheme,t)}b(i)},400),u.cbSend(function(){var r=u.$loading,t=function(t,e){var s,a,n,o;s=t,a=e,(o=p[n=i]).liveResponse.status=s,o.liveResponse.body=a,b(n,a),o.Layout.setStatusCode(s),r.fadeOut("slow")};setTimeout(function(){Restform.send(c.url,d.method,d.reqHeaders,d.reqBody,t)},100),r.fadeIn()}),u.cbSwitchResponse(function(t){var e,s;s=t?(e=c.liveResponse.status,c.liveResponse.body):(e=d.statusCode,d.resBody),u.setStatusCode(e),b(i,s)}),u.cbParams(function(t){d.params=t,u.setUrl(h(c))}),u.cbHeaders(function(t){d.headers=t,"function"==typeof d.chageHeadersCallback&&d.chageHeadersCallback(t)}),e=u.$layout,c.$app=e;var m=u.$nav,f=m.outerHeight();e.css("padding-top",f).on("show.bs.modal",function(){m.fadeIn("slow")}).on("hide.bs.modal",function(){m.fadeOut()}),m.hide().css("opacity",1),this.html(e)}else e=c.$app,b(i);o=p[n=i],r=o.opt,(l=o.Layout).setTitle(r.title),l.setHost(r.host,r.endpoint),l.setUrl(h(o)),l.setMethod(r.method),l.setParams(r.params),l.setReqHeaders(r.reqHeaders),l.setResHeaders(r.resHeaders),l.setStatusCode(r.statusCode),r.schema&&(l.$reqForm&&(o.bodyForm=Restform.setupBrutusin(l.$reqForm,r.schema,function(t){v(n,t)})),l.setSchema(JSON.stringify(r.schema,null,r.indentationSpaces)),window.twbschema&&l.$attributes.html(twbschema.doc(null,r.schema))),e.modal("show")},window.Restform={}}(jQuery),function(){"use strict";window.Restform.setupAce=function(t,e,s,a){if(window.ace){var n=t.attr("id"),o=t.closest("section").find('[aria-controls="'+t.parent().attr("id")+'"]'),r=ace.edit(n);s&&""!==s||(s="dawn"),r.setTheme("ace/theme/"+s),r.session.setMode("ace/mode/json"),e?r.setReadOnly(!0):r.on("blur",function(){var t;try{t=JSON.parse(r.session.getValue())}catch(t){return}a(t)});var i=function(){setTimeout(function(){r.focus(),r.renderer.updateFull()},200)};return t.click(i),o.click(i),function(t){r.session.setValue(t)}}return null}}(),function(){"use strict";window.Restform.setupBrutusin=function(e,t,s){if(window.brutusin){var a=brutusin["json-forms"],n=a.create(t);a.postRender=function(t){e.find("input").change(function(){s(t.getData())})};var o=e[0];return function(t){e.html(""),Object.assign({},n).render(o,t)}}return null}}(),function(B){"use strict";window.Restform.layout=function(b){b="restform-"+b+"-";var e=B("<h5>",{class:"restform-title"}),s=B("<span>",{class:"restform-endpoint"}),a=B("<span>",{class:"input-group-text",type:"text"}),n=B("<input>",{class:"form-control",type:"text",readonly:!0,click:function(){B(this).select()}}),o=B("<button>",{class:"btn btn-success mx-2",type:"button","aria-label":"Send",html:'<i class="ti ti-check mr-1"></i> Send'}),t=B("<nav>",{id:b+"nav",class:"shadow-sm restform-nav",html:B("<div>",{class:"container",html:[B("<div>",{class:"row no-gutters",html:[B("<div>",{class:"col",html:B("<div>",{class:"input-group",html:[B("<div>",{class:"input-group-prepend",html:a}),n]})}),B("<div>",{class:"col-auto",html:[o,B("<button>",{class:"btn btn-light",type:"button","aria-label":"Close",html:'<i class="ti ti-close"></i>',click:function(){T.modal("hide")}})]})]})]})}),r=function(t){return B("<header>",{class:"restform-header",html:B("<div>",{class:"container",html:t})})},l=function(t,e,s){t=b+t;for(var a=[],n=[],o={},r={},i=0;i<e.length;i++){var l=e[i],c=t+"-pane-"+l,d=t+"-item-"+l,u={class:"nav-item nav-link",id:d,"data-toggle":"tab",href:"#"+c,role:"tab","aria-controls":c,"aria-selected":!1,text:l.charAt(0).toUpperCase()+l.slice(1)},m={class:"tab-pane fade",id:c,role:"tabpanel","aria-labelledby":d};0===i&&(u.class+=" active",u["aria-selected"]=!0,m.class+=" show active");var f=B("<div>",m);n.push(f);var p=B("<a>",u);a.push(p),r[l]=p,o[l]=f}return s||(s="nav-tabs"),{$html:[B("<nav>",{html:B("<div>",{class:"nav restform-tabs "+s,role:"tablist",id:t+"-tabs",html:a})}),B("<div>",{class:"tab-content restform-content",id:t+"-content",html:n})],$Navs:r,$Contents:o}},i=l("req",["params","body","headers","attributes"]),c=B("<section>",{id:b+"request",html:[r([e,s]),B("<div>",{class:"container",html:i.$html})]}),d=!1,u=B("<button>",{class:"btn btn-info",html:'<i class="ti-reload mr-1"></i> Switch to <b>Live</b>',click:function(){d=!d;var t=B(this).children("b");d?t.text("Sample"):t.text("Live")}});o.click(function(){d||u.click()});var m,f,p=B("<span>"),h=B("<div>",{class:"restform-loading",html:B("<div>",{html:B("<div>",{class:"restform-spinner",html:"<div></div><div></div>"})})}),v=l("res",["body","headers"]),y=B("<section>",{id:b+"response",html:[h,r(B("<span>",{class:"lead",html:['<span class="mr-2">Response</span>',p]})),B("<div>",{class:"container",html:[u,B("<div>",{class:"mt-4",html:v.$html})]})]}),g=function(t){t.removeClass("disabled")},$=function(t){t.addClass("disabled"),t.hasClass("active")&&setTimeout(function(){t.siblings(":not(.disabled)").first().click()},200)},w=function(t,e,s,a){var n,o=t.$Navs[e],r=t.$Contents[e],i=[];if("object"==typeof s&&null!==s){var l=Object.keys(s);if(l.length){g(o);for(var c=0;c<l.length;c++){var d,u,m,f=s[l[c]],p=[];if("object"==typeof f){if(d=f.key,(u=[]).push(d),m=f.value,f.required&&u.push('<span class="text-danger ml-2">required</span>'),f.description){var h=B("<a>",{class:"px-2 text-info",href:"javascript:;",html:'<i class="ti ti-help-alt"></i>',title:f.description});h.tooltip({html:!0,placement:"top",container:r}),u.push(h)}}else m=s[u=d=l[c]];p.unshift(B("<td>",{html:B("<code>",{html:u})}),B("<td>",{html:B("<input>",{class:"form-control form-control-sm",type:"text",readonly:!!a,"data-key":d,value:m})})),i.push(B("<tr>",{html:p}))}var v=(n=i,Array.isArray(s),B("<table>",{class:"table table-striped",id:b+"params",html:[B("<tbody>",{html:n})]}));return r.html(v),v}}$(o)},k=function(t,e,s){var a,n=t.$Contents.body,o=B("<textarea>",{class:"form-control",rows:12,id:b+"body-"+e});if(s){var r=l("body-"+e,["code","form"],"nav-pills"),i=[B("<p>",{class:"small",html:['<i class="ti-help-alt mr-2 text-info"></i>',B("<a>",{href:"javascript:;",html:"Body object structure",click:function(){t.$Navs.attributes.click()}})]})].concat(r.$html);n.html(i),r.$Contents.code.html(o),a=B("<form>",{class:"restform-form",action:"javascript:;",id:b+"form-"+e}),r.$Contents.form.html(a)}else n.html(o);return{$editor:o,$form:a}},R=k(v,"res").$editor,C=k(i,"req",!0),q=C.$editor,j=C.$form,x=B("<code>",{class:"language-json",id:b+"json-schema"});$(i.$Navs.attributes);var S=B("<div>",{class:"restform-attrs",id:b+"attrs"}),H=l("schema",["list","schema"],"nav-pills");H.$Contents.list.html(S),H.$Contents.schema.html(B("<pre>",{class:"restform-schema language-json",html:x})),i.$Contents.attributes.html(H.$html);var T=B("<article>",{class:"modal fade",tabindex:-1,role:"dialog",id:b+"modal","aria-labelledby":b+"modal","aria-hidden":!0,html:B("<div>",{class:"modal-dialog restform-modal",html:B("<div>",{class:"modal-content restform",html:[c,y]})})});return B("body").prepend(t),{setTitle:function(t){e.text(t)},setHost:function(t,e){s.html([t,B("<strong>",{html:e.replace(/{([^}]+)}/g,"<span>$1</span>")})])},setMethod:function(t){switch(a.text(t),t){case"GET":case"DELETE":$(i.$Navs.body)}},setUrl:function(t){n.val(t)},setParams:function(t){var s=w(i,"params",t);if(s){var a=function(){if("function"==typeof m){var a=[];s.find("tr").each(function(){var t,e,s=B(this).find("input");""!==(e=1===s.length?(t=s.data("key"),s.val()):(t=s.first().val(),s.last().val()))&&""!==t&&a.push({key:t,value:e})}),m(a)}};s.find("input").change(a),s.after(B("<button>",{class:"btn btn-sm btn-light",type:"button",html:'<i class="ti ti-plus mr-1 text-primary"></i> Add a new query parameter',click:function(){var t=B("<input>",{class:"form-control form-control-sm restform-input-code","data-type":"key",type:"text",change:a}),e=B("<tr>",{html:[B("<td>",{html:B("<div>",{class:"input-group input-group-sm",html:[t,B("<div>",{class:"input-group-append",html:B("<button>",{class:"btn btn-outline-secondary",type:"button",html:'<i class="ti ti-trash"></i>',click:function(){e.remove(),a()}})})]})}),B("<td>",{html:B("<input>",{class:"form-control form-control-sm","data-type":"value",type:"text",change:a})})]});s.find("tbody").append(e),t.focus()}}))}},setSchema:function(t){x.text(t),g(i.$Navs.attributes)},setReqHeaders:function(t){var e=w(i,"headers",t);e&&e.find("input").change(function(){if("function"==typeof f){var s={};e.find("input").each(function(){var t=B(this).data("key"),e=B(this).val();""!==e&&""!==t&&(s[t]=e)}),f(s)}})},setResHeaders:function(t){w(v,"headers",t,!0)},setStatusCode:function(t){var e;e=200<=t&&t<300?"success":300<=t&&t<400?"info":400<=t&&t<500?"danger":500<=t?"dark":"secondary",p.attr("class","badge badge-"+e).text(t)},cbSend:function(t){o.click(t)},cbSwitchResponse:function(t){u.click(function(){t(d)})},cbParams:function(t){m=t},cbHeaders:function(t){f=t},$reqBody:q,$reqForm:j,$resBody:R,$schema:x,$attributes:S,$loading:h,$layout:T,$nav:t}}}(jQuery),function(l){"use strict";window.Restform.send=function(t,e,s,a,n){var o={url:t,method:e,dataType:"json",contentType:"application/json; charset=UTF-8"};s&&(o.headers=s),a&&(o.data=JSON.stringify(a));var r=function(t,e){if(t){var s=t.responseJSON,a=t.status;n?n(a,s):console.log(a,s)}else e&&console.error(e)},i=l.ajax(o);return i.done(function(t,e,s){r(s)}),i.fail(function(t,e,s){r(t,s)}),i},window.Restform.parseEndpoint=function(t,e){var s,a,n=[];for(s=0;s<e.length;s++){var o=(a=e[s]).key,r=a.value;"string"==typeof r&&""!==r&&(new RegExp("{"+o+"}").test(t)?t=t.replace(new RegExp("{"+o+"}"),r):n.push(a))}if(t=t.replace(/{[^}]+}/g,""),n.length){var i="?";for(s=0;s<n.length;s++)0<s&&(i+="&"),i+=(a=n[s]).key+"="+a.value;t+=i}return t}}(jQuery);